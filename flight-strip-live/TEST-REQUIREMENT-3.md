# Test Documentation — Requirement #3 (News Articles)

Date: 2026-01-22

This document verifies that **Requirement #3** (GitHub issue #3: *News Articles*) works end-to-end in the local dev environment.

## Environment

- App: Next.js 16 (App Router)
- DB: SQLite (`database.db`) via libsql + Drizzle
- Command used: `npm run dev`
- Browser verification: Playwright MCP (driving Chrome against `http://localhost:3000`)

## Preconditions

1. Ensure the database schema is up to date:
   - `npm run db:update`
2. Ensure demo data exists (includes 5 news entries):
   - Visit `/populate`, click **Populate Database**, type `DELETE`, click **Confirm**.

## Test Cases

### TC1 — Populate seeds `news` table

**Steps**
1. Open `http://localhost:3000/populate`.
2. Trigger the populate flow and confirm.

**Expected Results**
- Page shows status "Database populated successfully."
- Stats show `News = 5`.

**Evidence**
- Screenshot: `test-artifacts/requirement-3/01-populate-success.png`

### TC2 — Home page displays Latest News list

**Steps**
1. Open `http://localhost:3000/`.

**Expected Results**
- A "Latest News" section appears below the welcome text.
- News items are listed (current time within `valid_from` and `valid_to`, or `valid_to` is null).
- Items are sorted by `valid_from` descending (most recent first).
- Each list item shows `title` and a human-readable `valid_from` date.

**Evidence**
- Screenshot: `test-artifacts/requirement-3/02-home-latest-news.png`

### TC3 — News details page renders Markdown safely

**Steps**
1. From the home page, click the "Markdown example" news item.

**Expected Results**
- Navigates to `/news/{id}`.
- Page shows title, "Valid from" date, and full content.
- Markdown renders as HTML (e.g., headings, list, link).
- Rendered HTML is sanitized to mitigate XSS.

**Evidence**
- Screenshot: `test-artifacts/requirement-3/03-news-details-markdown.png`

## Notes

- Demo data for news is generated by the populate flows (`/populate` server action and `/api/populate`).
- Markdown rendering uses `marked` and HTML is sanitized using `dompurify` with a server-side `jsdom` window.
